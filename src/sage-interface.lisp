;;;; -*- Mode: Lisp; Syntax: ANSI-Common-Lisp; Base: 10 -*



(IN-PACKAGE #:cat)

(PROVIDE "sage-interface")



;;;;; Chain complexes ;;;;;


(DEFVAR *ASCII-NUM-START* 48)
(DEFVAR *ASCII-NUM-END* 57)


(DEFUN ITOA (value)
  (if (not (integerp value)) (error "Wrong type"))
  (if (zerop value)
      (return-from itoa "0"))
  (let ((negative? nil))
    (if (< value 0)
	(progn
	  (setf negative? t)
	  (setf value (abs value))))
    (loop
       for num = value then (floor num 10)
       for reminder = (mod num 10)
       while (> num 0)
       collect
	 (code-char (+ reminder *ASCII-NUM-START*)) into result
       finally
	 (if negative? (push #\- (cdr (last result))))
	 (return (format nil "狺铗弼弪箦蝈篚祠┅┅┅呐普釉颐猎é蝈篝篝蜷铉螬ㄡ痧禊с镱汜翦钺翦篝蜷铉篝蜷铉螬呐仆撩蚁桥铛肀铛聿啜蝈徜骝镯篝蜷铉篝蜚狒⑶ㄩ麸铛肀⑶ㄩ麸铛聿┅┅呐普寺劣捎筱桡愆｜序秭殇翳箪雉衡狍轶镦翳隋铤镉轫痨殂獒煊弭镡翎轭邃怡狃痨轭翳骢钽糸镱嗣栳轭蔑眇戾麸筱桡恣ㄦ戾è蝮祠ㄤ轫戾è疳轵ㄡ篌镢溟筱桡愆┅ㄩ铛祆疳轵紊祜镳骘骝镯麸ūㄡ蝌狴溟礤铙轱ㄣ潋疳轵暴泔祆邈ㄧ孱溟氅┅┅翳忉箝＇蝮祠┅呐普四破筱桡愆｜序秭殇翳箪雉洪铘颦滏骝镦翳隋铤镉轫痨殂獒煊弭镡翎轭邃怡狃痨轭翳骢钽糸镱嗣栳轭蔑眇戾麸筱桡恣ㄦ戾è骝箪ㄤ轫珙颟戾舄è箦ū痫箝糸镱＼篚怏羼黩轸瀛麸篝蜷铉珙颟暴┅ㄤ轫哏铗蝈徜骝镯篝蜷铉篚怏羼黩轸瀛麸篝蜷铉珙颟箦皓┅铛磉珙蝈徜骝镯篝蜷铉篚怏羼黩轸瀛麸篝蜷铉珙颟ū箦皓┅┅ㄤ邈灬蝈ㄦ轼铛溟磉珙铛磉珙颟躅戾篌ㄥ聃犰溟溟磉珙颟簧臾铒黠螂轭ㄥ蝌矧⒆蚁吻纳团斡上巍　┅戾è疳轵ㄡ篌镢溟筱桡愆蝮祠ㄣ礅ū溟愆┅ㄩ铛祆疳轵蝮祠戾è溟ㄣ潋疳轵┅躅戾篌铛磉珙ㄡ蝌狴溟礤铙轱溟暴ㄥ蝌矧⒆蚁吻桥闻伊韵摇　┅箦翩ㄣ礅瞽扉篝蝮祠祜镳骘骝镯麸ūㄡ蝌狴溟礤铙轱溟癌躅戾篌ㄥㄡ蝈溟铛磉珙颟癌泔祆邈翦蝽ㄡ蝈溟铛磉珙颟ㄧ孱ū溟愆椹┅蝮祠┅┅┅＇骝箪舂呐普黔猛幸ㄇ钋肀穷琼博｜序秭殇翳箪雉恒眇镦翳隋铤镉轫痨殂獒煊弭镡翎轭邃怡狃痨轭翳骢钽糸镱嗣栳轭蔑眇戾麸筱桡恣戾舄è箦ū痫箝糸镱＼篚怏羼黩轸瀛麸篝蜷铉穷琼暴暴┅肀蝈徜骝镯篝蜷铉篚怏羼黩轸瀛麸篝蜷铉穷琼暴ū箦皓┅聿蝈徜骝镯篝蜷铉篚怏羼黩轸瀛麸篝蜷铉穷琼博ū箦皓┅┅ㄤ邈灬蝈ㄦ轼铛肀聿┅翳沩痱ㄩ肀聿红弩ㄩ肀聿哄聃犰虹蝈狒弪┅┅呐普盼砸磲戛｜序秭殇翳孱趄轭蝻ч犷泔祯眍ш镦翳磲趄殂ы狒戾è戾骠ㄣ桢蜚桢颦栾ㄢ狍屐殓磲椹戛┅ㄩㄩ泔皓鲠皓癌┅呐普孟沃乓酝猎疑门磲趄殂濠｜蔑铞弪磲趄轼镦豉疱磲趄殂麸犷狎蜥戾舄è铛礞殪铎殓磲趄殂濠铛磴镬钽镬磲趄殂濠蝮祠磲脲狎蜥扉篝铛礞殪铛磴镬哄戾礤铘豉疱ф轼铛洪铋糸犰屐屙孱癌┅ㄤ雉轫弩ㄩ铛礞殪ㄤ雉轫弩铛磴镬戾è烷ㄥ铘蝙磲趄殂ū椹ū戛┅躅戾篌弪镳烷戛箦翩ㄡ蝈蝮祠戛烷戛┅┅蝮祠┅呐普萌猛土圆ㄣ桡瞟｜澡筢礤с桡憝磲臾骢钽糸镱怩轸滹弩铒痱轭镱筱蝈孱轭翦蝽邃獒翦泔眇豸狒轱铙ㄤ邈灬蝈豉疱汨衢瞽泔眇戾汨沩豉疱骈铛瞟戾è箫蜚ㄢ狍轶汨沩瞟趄玺ㄢ狍轶汨沩ū瞟┅ㄣ眇ㄣ眇汨沩┅ㄤ邈灬蝈扉篝箫蜚趄玺豉疱沩痱沩痱┅戾è箫蜚戾铉翳箫蜚┅磲ㄣ蝈弪磲趄殂戾铉翳趄玺戾铉翳箫蜚┅翦篝＇灬礅溽ㄧ铗舯珙螋博ㄥㄦ躅汜祆沩痱珙螋珙螋博哄聃犰┅┅ㄤ邈灬蝈豉疱骈铛箫蜚飑豉疱磲趄殂磲舂ㄦ躅泗轱翦篝┅ㄤèū椹磲螂箫蜚ㄣ潋磲螂┅è孱漯磲螂┅ㄤ邈灬蝈豉疱骈铛椹扉篝磲螂┅磲戥泔祜铑磲磲疸狎＇灬礅溽翦蝽ㄤ邈灬蝈豉疱翦蝽翦蝽┅扉篝ū痫箝糸镱ㄧ铗翦蝽趄玺呼弩翦篝┅ㄣ骀翦蝽┅ㄣ礅瞽扉篝汨沩ㄣ狎磲螂┅┅┅磲舂┅呐普土伺烈伊侪韵躺釉ㄡ蝌狴｜蔑铞弪犷狎蜥麸扉篝骘蝽邃怡翳狎蜥蝻黧祜镳骘忮祜ㄡ蝌狴溟礤铙轱狎蜥癌泔祆邈祜镳骘忮祜ㄡ蝌狴溟礤铙轱狎蜥暴泔祆邈ㄡ蝈狎蜥戛┅呐普土伺烈伊侪埔贤躺釉铗秣钽镬扉篝｜蔑铙趄蹉犷狎蜥骝镯扉篝骘蝽邃怡翳狎蜥蝻黧磲脲狎蜥扉篝铗秣钽镬螬洪铋糸犰泔铘孱趔扉篝┅呐普铝由舆琳乇脬桡溟愆ㄢ狍轶脬桡溟愆呐普弦俏吡肇脬桡愆矧珙脬桡愆呐普钠埔吡肇报脬桡溟沩忸哽轶舂｜拈骀弪孱糸犰镦泔礅鏖翳溟礤铙轱т轫犷с礅钸扉篝狍轸沩忸扉篝戾è泔礅ㄣ礅溟愆┅箦翩ㄣ礅瞽扉篝泔礅沩忸哽轶舂ㄤ骀脬桡泔礅┅呐普嗣攘晌孟托膛剡琳乇ㄣ桡篝蜻矧珙｜蔑铙趄蹉汨衢泔眇戾轭隋铤骝镯翳轭骘蝽狒轱镦翳狍箫扉篝с桡恣泔铙趄蹉翦骝镯溟泗轱钺蝙麒矬鲠祯弩狎磲趄殂弩ㄢ蹰熹汨沩恒眇＇黔猛幸后趄呵我衡狍轶脞狍轶汨沩洪铘颦滏骝脘骀汨沩猴蜱啜嗣栳轭蔑眇戾篝蜻矧珙┅换换娱眇扉汩犰渝趔换换呐普肆掠砸撩杂赏刑咆吡肇ㄤ彗孱弪徙殄钺礤ㄡ怏ㄤ顼瓠屮舡轭溴珏铄蜥汩弩钺礤┅呐普抡商沫粕紊耘佑扉篝｜澡筢礤р蹰熹骈铋翦篌骢钽糸镱怩轸滹弩铒汨邈翳驷沐蝈灬糸镱镦翳箝眇扉沐轭ъ轶臾ě汨邈氕箜篝镯轸翦洎ㄤ邈灬蝈扉篝扉篝┅戾è怏痤ㄦ轵篝扉篝┅翎忪ㄦ轭轸瀛篌翎忪扉篝┅ㄩ钿箜篝ㄧ孱簌愆┅ㄤ邈灬蝈簌礅镬怏痤轭洵箜篝箝眇戾鲥泗矧翎忪濠换鲥泗矧鲥泗矧珥箜驷沐蟓轭骘┅戾è蝮祠ㄢ蹰熹箜篝恒眇＇蟓沩痱衡狍轶ㄦ轭轸瀛篌忉箝翎忪濠衡箴怏痤烘徙ㄦ轭轸瀛篌驷沐轭洵箜篝翎忪濠洪铘颦忸潋ㄦ轭轸瀛篌轭趄忸潋轭洵箜篝翎忪濠衡钿颦篝螋虹铗猴蜱啜怩殪洵骈铋翦篌扉篝┅┅箦翩簌礅镬鲠祯轭洵箜篝蝮祠蝮祠┅呐普悠晌稍庞赏刑擅闪逃旁吡肇ㄦ轭轸弩扉黹舂｜蔑铙趄蹉扉篝ㄌ瘫添┈鏖翳冀ъ轫轸К麒弪遽汨扉篝屉轶骘蝽邃怡扉篝镦翳骘蝽ㄓㄡ犭┅麒弪遽汨彡轶驷沐镦翳氕箝眇戾戾è蝮祠紊泰ㄤèū氅┅è扉黹舂戾è溟黼紊泰ㄤ镬轶箝眇戾ㄢ狍轶骈铋翦篌氅戾è驷沐紊泰ㄤèū椹┅è癌瘐箬ㄦ徙骈铋翦篌箝眇戾驷沐螬瘐箬ㄣ镱箝眇戾驷沐螬溟黼┅瘐箬溟黼蝮祠┅蝈鲥蝮蝮祠┅