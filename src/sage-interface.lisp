;;;; -*- Mode: Lisp; Syntax: ANSI-Common-Lisp; Base: 10 -*



(IN-PACKAGE #:cat)

(PROVIDE "sage-interface")


;;;;; Chain complexes ;;;;;


(DEFVAR *ASCII-NUM-START* 48)
(DEFVAR *ASCII-NUM-END* 57)


(DEFUN ITOA (value)
  (if (not (integerp value)) (error "Wrong type"))
  (if (zerop value)
      (return-from itoa "0"))
  (let ((negative? nil))
    (if (< value 0)
	(progn
	  (setf negative? t)
	  (setf value (abs value))))
    (loop
       for num = value then (floor num 10)
       for reminder = (mod num 10)
       while (> num 0)
       collect
	 (code-char (+ reminder *ASCII-NUM-START*)) into result
       finally
	 (if negative? (push #\- (cdr (last result))))
	 (return (format nil "狺铗弼弪箦蝈篚祠┅┅┅呐普釉颐猎é蝈篝篝蜷铉螬ㄡ痧禊с镱汜翦钺翦篝蜷铉篝蜷铉螬呐仆撩蚁桥铛肀铛聿啜蝈徜骝镯篝蜷铉篝蜚狒⑶ㄩ麸铛肀⑶ㄩ麸铛聿┅┅呐普寺劣捎筱桡愆｜序秭殇翳箪雉衡狍轶镦翳隋铤镉轫痨殂獒煊弭镡翎轭邃怡狃痨轭翳骢钽糸镱嗣栳轭蔑眇戾麸筱桡恣ㄦ戾è蝮祠ㄤ轫戾è疳轵ㄡ篌镢溟筱桡愆┅ㄩ铛祆疳轵紊祜镳骘骝镯麸ūㄡ蝌狴溟礤铙轱ㄣ潋疳轵暴泔祆邈ㄧ孱溟氅┅┅翳忉箝＇蝮祠┅呐普四破筱桡愆｜序秭殇翳箪雉洪铘颦滏骝镦翳隋铤镉轫痨殂獒煊弭镡翎轭邃怡狃痨轭翳骢钽糸镱嗣栳轭蔑眇戾麸筱桡恣ㄦ戾è骝箪ㄤ轫珙颟戾舄è箦ū痫箝糸镱＼篚怏羼黩轸瀛麸篝蜷铉珙颟暴┅ㄤ轫哏铗蝈徜骝镯篝蜷铉篚怏羼黩轸瀛麸篝蜷铉珙颟箦皓┅铛磉珙蝈徜骝镯篝蜷铉篚怏羼黩轸瀛麸篝蜷铉珙颟ū箦皓┅┅ㄤ邈灬蝈ㄦ轼铛溟磉珙铛磉珙颟躅戾篌ㄥ聃犰溟溟磉珙颟簧臾铒黠螂轭ㄥ蝌矧⒆蚁吻纳团斡上巍　┅戾è疳轵ㄡ篌镢溟筱桡愆蝮祠ㄣ礅ū溟愆┅ㄩ铛祆疳轵蝮祠戾è溟ㄣ潋疳轵┅躅戾篌铛磉珙ㄡ蝌狴溟礤铙轱溟暴ㄥ蝌矧⒆蚁吻桥闻伊韵摇　┅箦翩ㄣ礅瞽扉篝蝮祠祜镳骘骝镯麸ūㄡ蝌狴溟礤铙轱溟癌躅戾篌ㄥㄡ蝈溟铛磉珙颟癌泔祆邈翦蝽ㄡ蝈溟铛磉珙颟ㄧ孱ū溟愆椹┅蝮祠┅┅┅＇骝箪舂呐普黔猛幸ㄇ钋肀穷琼博｜序秭殇翳箪雉恒眇镦翳隋铤镉轫痨殂獒煊弭镡翎轭邃怡狃痨轭翳骢钽糸镱嗣栳轭蔑眇戾戾舄è箦ū痫箝糸镱＼篚怏羼黩轸瀛麸篝蜷铉穷琼暴暴┅肀蝈徜骝镯篝蜷铉篚怏羼黩轸瀛麸篝蜷铉穷琼暴ū箦皓┅聿蝈徜骝镯篝蜷铉篚怏羼黩轸瀛麸篝蜷铉穷琼博ū箦皓┅┅ㄤ邈灬蝈ㄦ轼铛肀聿┅翳沩痱ㄩ肀聿红弩ㄩ肀聿哄聃犰虹蝈狒弪┅┅呐普门烫猛幸ㄣ屐爝溥肀沐祆咪唔博｜序秭殇翳箪雉恒眇镦翳隋铤镉轫痨殂獒煊弭镡翎轭邃怡狃痨轭翳骢钽糸镱似轭轸逵轫痨殂獒煊弭麸筱桡恣戾舄è箦ū痫箝糸镱＼篚怏羼黩轸瀛麸篝蜷铉沐祆咪唔暴订┅肀蝈徜骝镯篝蜷铉篚怏羼黩轸瀛麸篝蜷铉沐祆咪唔暴ǐ箦皓┅聿蝈徜骝镯篝蜷铉篚怏羼黩轸瀛麸篝蜷铉沐祆咪唔博ǐ箦皓┅┅ㄤ邈灬蝈ㄦ轼铛肀聿┅翳沩痱ㄩ肀聿红弩ㄩ肀聿哄聃犰虹蝈狒弪┅┅呐普盼砸磲戛｜序秭殇翳孱趄轭蝻ч犷泔祯眍ш镦翳磲趄殂ы狒戾è戾骠ㄣ桢蜚桢颦栾ㄢ狍屐殓磲椹戛┅ㄩㄩ泔皓鲠皓癌┅呐普孟沃乓酝猎疑门磲趄殂濠｜蔑铞弪磲趄轼镦豉疱磲趄殂麸犷狎蜥戾舄è铛礞殪铎殓磲趄殂濠铛磴镬钽镬磲趄殂濠蝮祠磲脲狎蜥扉篝铛礞殪铛磴镬哄戾礤铘豉疱ф轼铛洪铋糸犰屐屙孱癌┅ㄤ雉轫弩ㄩ铛礞殪ㄤ雉轫弩铛磴镬戾è烷ㄥ铘蝙磲趄殂ū椹ū戛┅躅戾篌弪镳烷戛箦翩ㄡ蝈蝮祠戛烷戛┅┅蝮祠┅呐普萌猛土圆ㄣ桡瞟｜澡筢礤с桡憝磲臾骢钽糸镱怩轸滹弩铒痱轭镱筱蝈孱轭翦蝽邃獒翦泔眇豸狒轱铙ㄤ邈灬蝈豉疱汨衢瞽泔眇戾汨沩豉疱骈铛瞟戾è箫蜚ㄢ狍轶汨沩瞟趄玺ㄢ狍轶汨沩ū瞟┅ㄣ眇ㄣ眇汨沩┅ㄤ邈灬蝈扉篝箫蜚趄玺豉疱沩痱沩痱┅戾è箫蜚戾铉翳箫蜚┅磲ㄣ蝈弪磲趄殂戾铉翳趄玺戾铉翳箫蜚┅翦篝＇灬礅溽ㄧ铗舯珙螋博ㄥㄦ躅汜祆沩痱珙螋珙螋博哄聃犰┅┅ㄤ邈灬蝈豉疱骈铛箫蜚飑豉疱磲趄殂磲舂ㄦ躅泗轱翦篝┅ㄤèū椹磲螂箫蜚ㄣ潋磲螂┅è孱漯磲螂┅ㄤ邈灬蝈豉疱骈铛椹扉篝磲螂┅磲戥泔祜铑磲磲疸狎＇灬礅溽翦蝽ㄤ邈灬蝈豉疱翦蝽翦蝽┅扉篝ū痫箝糸镱ㄧ铗翦蝽趄玺呼弩翦篝┅ㄣ骀翦蝽┅ㄣ礅瞽扉篝汨沩ㄣ狎磲螂┅┅┅磲舂┅呐普土伺烈伊侪韵躺釉ㄡ蝌狴｜蔑铞弪犷狎蜥麸扉篝骘蝽邃怡翳狎蜥蝻黧祜镳骘忮祜ㄡ蝌狴溟礤铙轱狎蜥癌泔祆邈祜镳骘忮祜ㄡ蝌狴溟礤铙轱狎蜥暴泔祆邈ㄡ蝈狎蜥戛┅呐普土伺烈伊侪埔贤躺釉铗秣钽镬扉篝｜蔑铙趄蹉犷狎蜥骝镯扉篝骘蝽邃怡翳狎蜥蝻黧磲脲狎蜥扉篝铗秣钽镬螬洪铋糸犰泔铘孱趔扉篝┅呐普钠埔琳脬桡愆ㄤ骀脬桡愆呐普铝由迎琳脬桡溟愆ㄢ狍轶脬桡溟愆呐普弦俏琳脬桡愆矧珙脬桡愆呐普猛幸琳脬桡愆ㄣ眇脬桡愆呐普猛挛琳ㄤ彗狍箫沆轶舂戾è蝮祠ㄣ礅溴珧┅箦翩ㄣ礅瞽扉篝蝮祠狍箫沆轶舂蝮祠┅呐普钠埔琳乇脬桡沩忸｜拈骀弪孱糸犰镦泔礅轭狒轱с礅瞌ㄤ骀脬桡沩忸┅呐普嗣攘晌孟托膛丨琳ㄣ桡篝蜻矧珙｜蔑铙趄蹉汨衢泔眇戾轭隋铤骝镯翳轭骘蝽狒轱镦翳狍箫扉篝с桡恣泔铙趄蹉翦骝镯溟泗轱钺蝙麒矬鲠祯弩狎磲趄殂弩ㄢ蹰熹汨沩恒眇＇黔猛幸后趄呵我衡狍轶脞狍轶汨沩洪铘颦滏骝脘骀汨沩猴蜱啜嗣栳轭蔑眇戾篝蜻矧珙┅换换惋蝠栝箜忮赭邋描衢蔑眇戾弩换换呐普抡商沫鸵腥琳箫蜚趄玺溴珧轭趄篝螋矧珙ㄢ蹰熹眚痂后矧箫蜚呼蜱趄玺轰彗溴珧洪铘轭趄后趄篝螋猴蜱矧珙┅呐普酉颐琳眚痂箫蜚眚痂┅呐普砸窃琳眚痂趄玺眚痂┅呐普呐且琳眚痂ㄤ彗眚痂┅呐普萌廖桥酉颐砸窃琳眚痂箫躜沐翎蜱弭ㄣ栳铉瀛箫蜚趄玺眚痂侯鬻箫蜚箫躜沐侯鬻趄玺翎蜱弭┅呐普挠砸萌廖桥酉颐砸窃琳眚痂箫躜沐翎蜱弭ㄤ篝颦汨犷珏箫蜚趄玺眚痂侯鬻箫蜚箫躜沐侯鬻趄玺翎蜱弭┅呐普胖撂樟陨衔琳眚痂沩忸眚痂沩忸┅呐普松卧箜蝠瑭｜序秭殇翳箪雉洪铘镦翳隋铤锩栳轭蔑眇戾惋蝠栝箜镡翎轭邃怡狃痨轭翳骢钽糸镱送矧痂轶砻栳轭蔑眇戾麸箜蝠瑙ㄦ戾è骝箪ㄤ轫珙颟戾舄è箦ū痫箝糸镱＼篚怏羼黩轸瀛麸篝蜷铉珙颟暴┅ㄤ轫哏铗蝈徜骝镯篝蜷铉篚怏羼黩轸瀛麸篝蜷铉珙颟箦皓┅铛磉珙蝈徜骝镯篝蜷铉篚怏羼黩轸瀛麸篝蜷铉珙颟ū箦皓┅┅ㄤ邈灬蝈ㄦ轼铛溟磉珙铛磉珙颟躅戾篌ㄥ聃犰溟溟磉珙颟簧臾铒黠螂轭ㄥ蝌矧⒆蚁吻纳团斡上巍　┅戾è疳轵ㄡ篌镢溟箜蝠瑭蝮祠ㄣ礅溟愆┅ㄩ铛祆疳轵蝮祠戾è眙蝤ㄣ潋疳轵┅躅戾篌铛磉珙ㄡ蝌狴溟礤铙轱眙蝤暴ㄥ蝌矧⒆蚁吻桥闻伊韵摇　┅箦翩ㄣ礅瞽扉篝蝮祠祜镳骘骝镯麸ūㄡ蝌狴溟礤铙轱眙蝤癌躅戾篌ㄥㄡ蝈眙蝤铛磉珙颟癌泔祆邈翦蝽ㄡ蝈眙蝤铛磉珙颟ㄧ孱溟椹┅蝮祠┅┅┅＇骝箪舂呐普嗣攘晌孟托膛赝弦腥捎铜琳眚痂箫蜚趄玺｜蔑铙趄蹉汨衢泔眇戾盹蝠栝箜轭隋铤骝镯翳轭骘蝽狒轱镦翳狍箫扉篝ы蝠瑙泔铙趄蹉翦骝镯溟泗轱钺蝙麒矬鲠祯弩狎磲趄殂弩ㄢ蹰熹眚痂后矧箫蜚呼蜱趄玺后趄呵我洪铘腴铘眚痂猴蜱啜嗣栳轭蔑眇戾惋蝠栝箜箫蜚趄玺眚痂┅换换娱眇扉汩犰渝趔换换呐普谅油琳ㄤ顼珥箜ㄡ怏溏镳珥箜┅呐普呐桥闻伊耘ㄡ怏愆ㄤ彗孱弪狒瀛徕箜┅呐普蜗苇呐桥闻伊耘ㄡ怏愆铒瞽溴珏铄蜥翦徕箜┅呐普靡幸谅油迎琳ㄡ怏肀徕箜博ㄣ蝠徕箜徕箜博呐普谅油ㄣ蝠颟ㄡ怏肀泸痱┅呐普谅油ㄣ蝠颟ㄡ怏聿泸痱┅呐普肆掠砸撩杂赏刑咆琳ㄤ彗孱弪徙殄钺礤ㄡ怏ㄤ顼瓠屮舡轭溴珏铄蜥汩弩钺礤┅呐普抡商沫粕紊耘佑ㄩ铈铹｜澡筢礤р蹰熹骈铋翦篌骢钽糸镱怩轸滹弩铒汨邈翳驷沐蝈灬糸镱镦翳箝眇扉沐轭ч铈铵ě汨邈氕箜篝镯轸翦洎ㄤ邈灬蝈扉篝轭骘┅戾è怏痤ㄦ轵篝轭骘┅翎忪ㄦ轭轸瀛篌翎忪轭骘┅ㄩ钿箜篝ㄧ孱簌愆┅ㄤ邈灬蝈簌礅镬怏痤轭洵箜篝箝眇戾鲥泗矧翎忪濠换鲥泗矧鲥泗矧珥箜驷沐蟓轭骘┅戾è蝮祠ㄢ蹰熹箜篝恒眇＇蟓沩痱秋镤沩痱衡狍轶ㄦ轭轸瀛篌忉箝翎忪濠衡箴怏痤烘徙ㄦ轭轸瀛篌驷沐轭洵箜篝翎忪濠洪铘颦忸潋ㄦ轭轸瀛篌轭趄忸潋轭洵箜篝翎忪濠衡钿颦篝螋虹铗猴蜱啜怩殪洵骈铋翦篌轭骘┅┅箦翩簌礅镬鲠祯轭洵箜篝蝮祠蝮祠┅呐普悠晌稍庞赏刑擅闪逃旁琳ㄦ轭轸弩扉黹舂｜蔑铙趄蹉扉篝ㄌ瘫添┈鏖翳冀ъ轫轸К麒弪遽汨扉篝屉轶骘蝽邃怡扉篝镦翳骘蝽ㄓㄡ犭┅麒弪遽汨彡轶驷沐镦翳氕箝眇戾戾è蝮祠紊泰ㄤèū氅┅è扉黹舂戾è溟黼紊泰ㄤ镬轶箝眇戾ㄢ狍轶骈铋翦篌氅戾è驷沐紊泰ㄤèū椹┅è癌瘐箬ㄦ徙骈铋翦篌箝眇戾驷沐螬瘐箬ㄣ镱箝眇戾驷沐螬溟黼┅瘐箬溟黼蝮祠┅蝈鲥蝮蝮祠┅换换惋蝠栝箜忮赭邋娱眇扉汩犰渝趔换换呐普劣酉铆韵普蚊陨衔ㄡ篌镢扉篝ㄦ戾è骝箪ㄣ潋ㄡ篌镢狍箫沆轶舂┅＇骝箪舂呐普擞晌砸箜眚溟泗｜序秭殇翳箪雉后轭趄镦翳隋铤镉轫痨殂獒煊弭惋蝠栝箜镡翎轭邃怡狃痨轭翳骢钽糸镱擞轫痨殂獒煊弭惋蝠栝箜ㄦ戾è骝箪ㄤ轫珙颟ㄦ躅汜祆ㄡ篌镢麸骢钽糸镱箜眚溟泗珙颟┅＇骝箪舂呐普擞赏刑擅闪逃旁拖倚壬油琳箜眚溟泗箫蜚趄玺｜蔑铙趄蹉箝眇扉汩犰箦盹蝠栝箜轭隋铤骝镯翳轭骘蝽狒轱镦翳狍箫扉篝箜眚溟泗泔铙趄蹉翦骝镯溟泗轱钺蝙麒矬鲠祯弩狎徕篝蜥泗箝眇戾弩ㄢ蹰熹箜眚后矧箫蜚呼蜱趄玺后趄呵我后轭趄塍轭趄箜眚溟泗猴蜱啜擞轫痨殂獒煊弭惋蝠栝箜箫蜚趄玺箜眚溟泗┅呐普胖撂樟耘由托膛箜眚溟箝眇戾箜眚溟箝眇戾┅呐普胖撂樟耘猛挛箜眚沩忸箜眚沩忸┅